<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espião de Produtos</title>
    <link href="https://fonts.googleapis.com/css2?family=Canva+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        /* Estilos (sem alteração) */
    </style>
</head>
<body>
    <div class="container">
        <h1>🎁 Descubra o produto do seu concorrente</h1>
        <div style="display: flex; justify-content: center; align-items: center;">
            <input type="text" id="productInput" placeholder="Digite o código de transação: HP0232392842">
            <button class="whatsapp-button" onclick="openPopup()">
                <i class="material-icons">arrow_forward</i>
            </button>
        </div>
        <div class="button-group">
            <a href="https://inexplor.com" class="button footer-button">🤑 Quero +150 Produtos Ocultos Secretos</a>
            <a href="https://ajuda.inexplor.com/hpx9/preciso-ajuda" class="button footer-button">😞 Preciso de Ajuda com o Espião</a>
        </div>
    </div>

    <!-- Popup -->
    <div id="popup" class="popup">
        <span class="close-btn" onclick="closePopup()">X</span>
        <p>OBRIGATÓRIO: Compartilhe o Espião com um Afiliado para usar de graça!</p>
        <button class="button" onclick="redirectToEspiao()">Vou Compartilhar Agora Mesmo!</button>
        <button class="button" onclick="sendToWhatsApp()">Pode Checar! Já Compartilhei</button>
    </div>

    <!-- Notificação de espionagem -->
    <div id="notification" class="notification"></div>

    <script>
        let typingTimer;
        let notificationCount = 0;
        const productInput = document.getElementById('productInput');
        const notification = document.getElementById('notification');
        const popup = document.getElementById('popup');

        // Função para mostrar notificação "x pessoas espionando agora!" no canto superior direito
        setInterval(() => {
            notificationCount++;
            notification.textContent = `${notificationCount} pessoa(s) espionando agora!`;
            notification.style.display = 'block';
            
            // A notificação desaparece após 5 segundos
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }, 60000); // a cada 1 minuto

        // Função para validar o formato do código e enviar para WhatsApp
        function sendToWhatsApp() {
            const productCode = productInput.value.trim();
            if (productCode && productCode.startsWith("HP")) {
                const url = `https://pay.hotmart.com/thanks?transactionReference=${encodeURIComponent(productCode)}`;
                window.open(url, '_blank');
            } else {
                alert("Ops! O código deve começar com 'HP'.");
            }
        }

        // Função para abrir o popup
        function openPopup() {
            popup.style.display = 'block';
        }

        // Função para fechar o popup
        function closePopup() {
            popup.style.display = 'none';
        }

        // Função para redirecionar para o link "Não Tenho o Espião"
        function redirectToEspiao() {
            const productCode = productInput.value.trim();
            if (productCode && productCode.startsWith("HP")) {
                const productCodeWith18 = productCode + "18";  // Adicionando o número 18
                const url = `https://api.whatsapp.com/send?text=Achei%20o%20produto%20de%20um%20afiliado%20pelo%20código%20de%20transação%20${encodeURIComponent(productCodeWith18)}%0ADá%20uma%20olhada%20%E2%9E%A0%20https%3A%2F%2Fespione.inexplor.com`;

                const newWindow = window.open(url, '_blank');
            } else {
                alert("O código de transação precisa começar com 'HP'.");
            }
        }

        // Função para criar emoticons sorridentes caindo
        function createSmiley() {
            const smiley = document.createElement('span');
            smiley.className = 'smiley';
            smiley.textContent = '🤑';
            document.body.appendChild(smiley);

            // Coloca o smiley em posições aleatórias no topo da tela
            smiley.style.left = Math.random() * window.innerWidth + 'px';

            // Remove o smiley quando ele sair da tela
            setTimeout(() => {
                smiley.remove();
            }, 1000);
        }

        // Monitorar quando o usuário começa a digitar
        productInput.addEventListener('input', () => {
            clearTimeout(typingTimer);
            typingTimer = setTimeout(() => {
                // Se o usuário parar de digitar, parar de cair os emoticons
                if (productInput.value.length > 0) {
                    createSmiley();
                }
            }, 200);

            // Continuar criando emoticons enquanto o usuário digitar
            if (productInput.value.length > 0) {
                createSmiley();
            }
        });
    </script>
</body>
</html>
